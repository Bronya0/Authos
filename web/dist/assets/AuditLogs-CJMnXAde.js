import{r as c,H as h,a as A,I as w,l as O,c as P,e as l,w as n,h as t,p as T,o as k,J as f,K as m,v as x,B as _,i as C,L as U,G as y,n as g}from"./index-Bh7ncf5g.js";import{c as E}from"./index-C99W1-_y.js";import{f as G}from"./format-CL3lqu5w.js";const R={style:{display:"flex","flex-direction":"column",gap:"16px"}},F={__name:"AuditLogs",setup(D){const d=h(),p=c(d.meta.system||!1),v=c([]),r=c(!1),s=A({action:null,resource:null,username:""});w(()=>d.meta.system,e=>{p.value=e||!1,i()});const b=[{label:"登录",value:"LOGIN"},{label:"登出",value:"LOGOUT"},{label:"创建",value:"CREATE"},{label:"更新",value:"UPDATE"},{label:"删除",value:"DELETE"},{label:"分配",value:"ASSIGN"},{label:"取消分配",value:"UNASSIGN"},{label:"系统登录",value:"SYSTEM_LOGIN"},{label:"应用登录",value:"APP_LOGIN"}],I=[{label:"用户",value:"USER"},{label:"角色",value:"ROLE"},{label:"菜单",value:"MENU"},{label:"接口权限",value:"API_PERMISSION"},{label:"应用",value:"APPLICATION"},{label:"角色权限关联",value:"ROLE_PERMISSION"}],N=e=>e.includes("LOGIN")?"success":e==="CREATE"?"info":e==="UPDATE"?"warning":e==="DELETE"?"error":"default",S=[{title:"时间",key:"CreatedAt",width:180,render:e=>G(e.CreatedAt)},{title:"操作人",key:"username",width:120},{title:"动作",key:"action",width:120,render:e=>y(g,{type:N(e.action),size:"small"},{default:()=>e.action})},{title:"资源",key:"resource",width:120},{title:"资源ID",key:"resourceId",width:100},{title:"内容",key:"content"},{title:"IP",key:"ip",width:130},{title:"状态",key:"status",width:80,render:e=>y(g,{type:e.status===1?"success":"error",size:"small"},{default:()=>e.status===1?"成功":"失败"})}],L={pageSize:15},i=async()=>{r.value=!0;try{const a=await(p.value?E.getSystemLogs:E.getLogs)(s);v.value=a||[]}catch(e){console.error("Failed to load audit logs:",e)}finally{r.value=!1}},u=()=>{i()};return O(i),(e,a)=>(k(),P("div",R,[l(t(T),null,{default:n(()=>[l(t(f),{vertical:""},{default:n(()=>[l(t(f),{align:"center"},{default:n(()=>[l(t(m),{value:s.action,"onUpdate:value":[a[0]||(a[0]=o=>s.action=o),u],placeholder:"操作类型",clearable:"",options:b,style:{width:"150px"}},null,8,["value"]),l(t(m),{value:s.resource,"onUpdate:value":[a[1]||(a[1]=o=>s.resource=o),u],placeholder:"资源类型",clearable:"",options:I,style:{width:"150px"}},null,8,["value"]),l(t(x),{value:s.username,"onUpdate:value":[a[2]||(a[2]=o=>s.username=o),u],placeholder:"操作人",clearable:"",style:{width:"150px"}},null,8,["value"]),l(t(_),{type:"primary",onClick:u},{default:n(()=>[...a[3]||(a[3]=[C("查询",-1)])]),_:1})]),_:1}),l(t(U),{columns:S,data:v.value,loading:r.value,pagination:L},null,8,["data","loading"])]),_:1})]),_:1})]))}};export{F as default};
